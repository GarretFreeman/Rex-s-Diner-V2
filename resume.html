<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>R√©sum√© d'activit√© - Rex Diner</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 40px;
      background-color: #f9f9f9;
    }

    .retour-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 8px 14px;
      background-color: #555;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }

    h1 {
      text-align: center;
      font-size: 28px;
      text-transform: uppercase;
      border-bottom: 2px solid #ccc;
      display: inline-block;
      padding-bottom: 6px;
      margin-bottom: 30px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 40px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      font-size: 14px;
    }

    th {
      background-color: #f0f0f0;
    }

    tr:nth-child(even) {
      background-color: #fafafa;
    }
  </style>
</head>
<body>

<button class="retour-btn" onclick="window.location.href='index.html'">‚¨ÖÔ∏è Retour √† l‚Äôaccueil</button>

<h1>üìä R√©sum√© d'activit√©</h1>

<table id="stat-table">
  <thead>
    <tr>
      <th>Nom</th>
      <th>Livraisons PNJ</th>
      <th>Montant Livraison PNJ</th>
      <th>Prime Livraison</th>
      <th>Ventes comptoir PNJ</th>
      <th>Montant Vente PNJ</th>
      <th>Prime Vente PNJ</th>
      <th>Facturation client</th>
      <th>Prime facturation</th>
      <th>Salaire total</th>
      <th>Derni√®re activit√©</th>
    </tr>
  </thead>
  <tbody id="stat-body"></tbody>
</table>

<script>
  fetch("https://script.google.com/macros/s/AKfycbwnVZDjR2cXNafXGMzTOuELEFpSCc7iG6luip_spEZdvogfYdWqEfsYUIt4hm3xCiUq/exec")
    .then(res => res.json())
    .then(data => {
      const stats = data.stat || []; // <-- doit √™tre renvoy√© dans l'API
      const tbody = document.getElementById("stat-body");

      stats.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row.nom}</td>
          <td>${row.livraisonsPNJ}</td>
          <td>${row.montantLivraison}</td>
          <td>${row.primeLivraison}</td>
          <td>${row.ventesPNJ}</td>
          <td>${row.montantVentePNJ}</td>
          <td>${row.primeVentePNJ}</td>
          <td>${row.facturation}</td>
          <td>${row.primeFacturation}</td>
          <td>${row.salaire}</td>
          <td>${row.derniereActivite}</td>
        `;
        tbody.appendChild(tr);
      });
    })
    .catch(err => {
      console.error("Erreur API :", err);
      document.getElementById("stat-body").innerHTML = `<tr><td colspan="11" style="color:red;">Erreur de chargement des donn√©es</td></tr>`;
    });
</script>

</body>
</html>
