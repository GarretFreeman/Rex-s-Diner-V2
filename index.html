<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Interface Caisse - Rex Diner</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }
    .container { display: flex; gap: 20px; max-width: 1600px; margin: auto; background: white; border-radius: 12px; padding: 20px; }
    .produits, .ticket { flex: 1; }
    .produit-grid, .contrat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
    }
    .produit-btn, .contrat-btn {
      background-color: #e0f2f1;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
    }
    .produit-btn:hover, .contrat-btn:hover { background-color: #b2dfdb; }
    .img-produit {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    .quantite-btns { display: flex; justify-content: center; gap: 6px; flex-wrap: wrap; }
    .quantite-btn { font-size: 12px; padding: 4px 8px; border: none; background-color: #c8e6c9; border-radius: 4px; cursor: pointer; }
    .quantite-btn:hover { background-color: #a5d6a7; }
    .ticket-content { background: #f0f0f0; padding: 10px; border-radius: 10px; min-height: 150px; }
  </style>
</head>
<body>

<div class="container">
  <div class="produits">
    <h2>Produits</h2>
    <div id="produit-grid" class="produit-grid"></div>
  </div>

  <div class="ticket">
    <h2>Contrats</h2>
    <div id="contrat-grid" class="contrat-grid"></div>
  </div>
</div>

<script>
  // Appel à votre Google Apps Script API
  fetch("https://script.google.com/macros/s/AKfycbzbt0DQ9lXROW4K5i5Grv3N2B-vnxK359dEzBNglBn4XZ66rea1g3rTx_85W6J8oCds/exec")
    .then(res => res.json())
    .then(data => {
      const produits = data.produits || [];
      const contrats = data.contrats || [];

      const produitGrid = document.getElementById("produit-grid");
      produits.forEach(({ nom, prix, image }) => {
        const div = document.createElement("div");
        div.className = "produit-btn";
        div.innerHTML = `
          ${image ? `<img src="${image}" class="img-produit" alt="${nom}">` : `<div>${nom}</div>`}
          <div class="quantite-btns">
            <button class="quantite-btn">+1</button>
            <button class="quantite-btn">+5</button>
            <button class="quantite-btn">+10</button>
          </div>
        `;
        produitGrid.appendChild(div);
      });

      const contratGrid = document.getElementById("contrat-grid");
      contrats.forEach(({ nom, remise, image, observation }) => {
        const div = document.createElement("div");
        div.className = "contrat-btn";
        div.title = observation || "";
        div.innerHTML = `
          <div>
            ${image ? `<img src="${image}" class="img-produit" alt="${nom}">` : `<strong>${nom}</strong>`}
            <div>- ${remise * 100}%</div>
          </div>
        `;
        div.onclick = () => alert(observation || "Aucune observation");
        contratGrid.appendChild(div);
      });
    })
    .catch(err => {
      console.error("Erreur lors de l'appel API :", err);
      document.body.innerHTML += `<p style="color:red;">Erreur lors de l'appel à l'API.</p>`;
    });
</script>

</body>
</html>
